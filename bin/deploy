#!/bin/bash
set -e

cd ~/stock-keep

echo "ğŸ‘‰ Pulling latest code..."
git pull origin main

echo "ğŸ‘‰ Installing dependencies..."
bundle install
yarn install

echo "ğŸ‘‰ Building JS/CSS..."
./bin/build

echo "ğŸ‘‰ Precompiling assets..."
RAILS_ENV=production bundle exec rails assets:precompile

echo "ğŸ‘‰ Running migrations..."
RAILS_ENV=production bundle exec rails db:migrate

echo "ğŸ‘‰ Restarting Rails app..."
sudo systemctl restart rails

echo "âœ… Deploy complete!"
